{"version":3,"file":"page.js","sourceRoot":"","sources":["page.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { doc, getDoc, collection, query, where, getDocs, updateDoc } from 'firebase/firestore';\nimport { db } from '@/lib/firebase/config';\nimport { format, isFuture } from 'date-fns';\nimport { fr } from 'date-fns/locale';\nimport { Card } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport Link from 'next/link';\nimport { useParams } from 'next/navigation';\nimport { \n  Calendar, \n  Check,\n  AlertCircle,\n  ChevronUp, \n  ChevronDown \n} from 'lucide-react';\n\n\ninterface AppointmentService {\n  title: string;\n  price: number;\n}\n\ninterface AppointmentStaff {\n  firstName: string;\n  lastName: string;\n}\n\ninterface Appointment {\n  id: string;\n  start: Date;\n  end: Date;\n  createdAt: Date;\n  clientEmail: string;\n  clientName: string;\n  clientPhone: string;\n  status: 'confirmed' | 'cancelled';\n  service: AppointmentService;\n  staff: AppointmentStaff;\n}\n\nexport default function ConfirmationPage() {\n    const params = useParams();\n    const [appointment, setAppointment] = useState<Appointment | null>(null);\n    const [pastAppointments, setPastAppointments] = useState<Appointment[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [cancelLoading, setCancelLoading] = useState(false);\n    const [showAllAppointments, setShowAllAppointments] = useState(false);\n\n\n    const fetchAppointmentHistory = async (clientEmail: string) => {\n      try {\n        // D'abord, récupérer tous les rendez-vous\n        const appointmentsQuery = query(\n          collection(db, 'appointments'),\n          where('clientEmail', '==', clientEmail),\n          where('status', 'in', ['confirmed', 'cancelled'])\n        );\n    \n        const querySnapshot = await getDocs(appointmentsQuery);\n    \n        // Ensuite, pour chaque rendez-vous, récupérer les détails\n        const appointments = await Promise.all(\n          querySnapshot.docs.map(async (appointmentDoc) => {\n            const data = appointmentDoc.data();\n            let serviceDetails;\n            let staffDetails;\n    \n            try {\n              // Récupération des détails du service\n              const serviceDoc = await getDoc(doc(db, 'services', data.serviceId));\n              serviceDetails = serviceDoc.exists() ? serviceDoc.data() : null;\n    \n              // Récupération des détails du staff\n              const staffDoc = await getDoc(doc(db, 'staff', data.staffId));\n              staffDetails = staffDoc.exists() ? staffDoc.data() : null;\n            } catch (error) {\n              console.error('Erreur lors de la récupération des détails:', error);\n            }\n    \n            // Construction de l'objet rendez-vous\n            return {\n              id: appointmentDoc.id,\n              start: data.start.toDate(),\n              end: data.end.toDate(),\n              createdAt: data.createdAt.toDate(),\n              clientEmail: data.clientEmail,\n              clientName: data.clientName,\n              clientPhone: data.clientPhone,\n              status: data.status,\n              service: {\n                title: serviceDetails?.title || 'Service inconnu',\n                price: serviceDetails?.price || 0\n              },\n              staff: {\n                firstName: staffDetails?.firstName || '',\n                lastName: staffDetails?.lastName || ''\n              }\n            };\n          })\n        );\n    \n        // Filtrer et trier les résultats\n        return appointments\n          .filter(apt => apt.id !== params.id)\n          .sort((a, b) => b.start.getTime() - a.start.getTime());\n    \n      } catch (error) {\n        console.error('Erreur lors de la récupération de l\\'historique:', error);\n        return [];\n      }\n    };\n\n    const handleCancelAppointment = async () => {\n        if (!appointment || !isFuture(appointment.start)) return;\n      \n        try {\n          setCancelLoading(true);\n          await updateDoc(doc(db, 'appointments', appointment.id), {\n            status: 'cancelled'\n          });\n      \n          setAppointment(prev => prev ? {...prev, status: 'cancelled'} : null);\n        } catch (error) {\n          console.error('Erreur lors de l\\'annulation:', error);\n          setError('Erreur lors de l\\'annulation du rendez-vous');\n        } finally {\n          setCancelLoading(false);\n        }\n      };\n\n      useEffect(() => {\n        const fetchData = async () => {\n          if (!params.id) return;\n      \n          try {\n            setLoading(true);\n            const appointmentDoc = await getDoc(doc(db, 'appointments', params.id as string));\n            \n            if (!appointmentDoc.exists()) {\n              setError('Rendez-vous non trouvé');\n              return;\n            }\n      \n            const data = appointmentDoc.data();\n      \n            // Récupérer les détails du service\n            const serviceDoc = await getDoc(doc(db, 'services', data.serviceId));\n            const serviceData = serviceDoc.data();\n      \n            // Récupérer les détails du staff\n            const staffDoc = await getDoc(doc(db, 'staff', data.staffId));\n            const staffData = staffDoc.data();\n      \n            const currentAppointment: Appointment = {\n              id: appointmentDoc.id,\n              start: data.start.toDate(),\n              end: data.end.toDate(),\n              createdAt: data.createdAt.toDate(),\n              clientEmail: data.clientEmail,\n              clientName: data.clientName,\n              clientPhone: data.clientPhone,\n              status: data.status,\n              service: {\n                title: serviceData?.title || 'Service inconnu',\n                price: serviceData?.price || 0\n              },\n              staff: {\n                firstName: staffData?.firstName || '',\n                lastName: staffData?.lastName || ''\n              }\n            };\n            \n            setAppointment(currentAppointment);\n      \n            if (data.clientEmail) {\n              const history = await fetchAppointmentHistory(data.clientEmail);\n              setPastAppointments(history);\n            }\n          } catch (error) {\n            console.error('Erreur:', error);\n            setError('Erreur lors du chargement des données');\n          } finally {\n            setLoading(false);\n          }\n        };\n      \n        fetchData();\n      }, [params.id]);\n\n    if (loading) {\n      return (\n        <div className=\"min-h-screen flex items-center justify-center\">\n          <div className=\"text-center\">Chargement...</div>\n        </div>\n      );\n    }\n\n    if (error || !appointment) {\n      return (\n        <div className=\"min-h-screen flex items-center justify-center\">\n          <Card className=\"w-full max-w-lg p-6\">\n            <div className=\"text-center\">\n              <h1 className=\"text-xl font-semibold text-red-600 mb-2\">\n                {error || 'Rendez-vous non trouvé'}\n              </h1>\n              <Link href=\"/\">\n                <Button>Retourner à l'accueil</Button>\n              </Link>\n            </div>\n          </Card>\n        </div>\n      );\n    }\n\n    const isAppointmentCancellable = \n      appointment.status === 'confirmed' && \n      isFuture(appointment.start);\n\n      return (\n        <div className=\"min-h-screen flex items-center justify-center p-4\">\n          <Card className=\"w-full max-w-2xl p-6 space-y-6\">\n            <div className=\"text-center\">\n              {appointment.status === 'cancelled' ? (\n                <>\n                  <div className=\"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4\">\n                    <AlertCircle className=\"w-6 h-6 text-red-600\" />\n                  </div>\n                  <h1 className=\"text-2xl font-bold text-gray-900\">\n                    Rendez-vous annulé\n                  </h1>\n                  <p className=\"mt-2 mb-6 text-gray-600\">\n                    Ce rendez-vous a été annulé\n                  </p>\n                  <Link href=\"/\" className=\"block\">\n                  <Button className=\"w-fit py-2 text-base bg-black hover:bg-gray-800\">\n  Prendre un nouveau rendez-vous ?\n</Button>\n                  </Link>\n                </>\n              ) : (\n                <>\n                  <div className=\"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n                    <Check className=\"w-6 h-6 text-green-600\" />\n                  </div>\n                  <h1 className=\"text-2xl font-bold text-gray-900\">\n                    Réservation confirmée !\n                  </h1>\n                  <p className=\"mt-2 text-gray-600\">\n                    Votre rendez-vous a été enregistré avec succès\n                  </p>\n                </>\n              )}\n            </div>\n            \n            <div className=\"bg-gray-50 rounded-lg p-4 space-y-3\">\n  <h2 className=\"font-medium\">Détails de votre rendez-vous :</h2>\n  <div className=\"space-y-2 text-sm\">\n    <p>\n      <span className=\"text-gray-500\">Service :</span>{' '}\n      <span className=\"font-medium\">{appointment.service.title}</span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Date :</span>{' '}\n      <span className=\"font-medium\">\n        {format(appointment.start, 'EEEE d MMMM yyyy', { locale: fr })}\n      </span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Heure :</span>{' '}\n      <span className=\"font-medium\">\n        {format(appointment.start, 'HH:mm')}\n      </span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Avec :</span>{' '}\n      <span className=\"font-medium\">\n        {appointment.staff.firstName} {appointment.staff.lastName}\n      </span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Prix :</span>{' '}\n      <span className=\"font-medium\">{appointment.service.price}€</span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Client :</span>{' '}\n      <span className=\"font-medium\">{appointment.clientName}</span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Email :</span>{' '}\n      <span className=\"font-medium\">{appointment.clientEmail}</span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Téléphone :</span>{' '}\n      <span className=\"font-medium\">{appointment.clientPhone}</span>\n    </p>\n    <p>\n      <span className=\"text-gray-500\">Statut :</span>{' '}\n      <span className={`font-medium ${\n        appointment.status === 'cancelled' \n          ? 'text-red-600'\n          : 'text-green-600'\n      }`}>\n        {appointment.status === 'cancelled' ? 'Annulé' : 'Confirmé'}\n      </span>\n    </p>\n  </div>\n</div>\n           \n            {isAppointmentCancellable && (\n              <div className=\"flex justify-center\">\n                <Button\n                  variant=\"destructive\"\n                  onClick={handleCancelAppointment}\n                  disabled={cancelLoading}\n                >\n                  {cancelLoading ? 'Annulation...' : 'Annuler ce rendez-vous'}\n                </Button>\n              </div>\n            )}\n      \n      {pastAppointments.length > 0 && (\n  <div className=\"mt-8\">\n    <h2 className=\"font-medium flex items-center gap-2 mb-4\">\n      <Calendar className=\"w-5 h-5\" />\n      Historique de vos rendez-vous\n    </h2>\n    <div className=\"space-y-4\">\n      {/* Afficher soit tous les rendez-vous, soit seulement les 2 plus récents */}\n      {(showAllAppointments ? pastAppointments : pastAppointments.slice(0, 2)).map((apt) => (\n        <div\n          key={apt.id}\n          className=\"p-3 border rounded-lg flex justify-between items-center hover:bg-gray-50\"\n        >\n          <div>\n            <p className=\"font-medium\">{apt.service.title}</p>\n            <p className=\"text-sm text-gray-500\">\n              {format(apt.start, 'EEEE d MMMM yyyy à HH:mm', { locale: fr })}\n            </p>\n            <p className=\"text-sm text-gray-500\">\n              Avec {apt.staff.firstName} {apt.staff.lastName}\n            </p>\n          </div>\n          <div>\n            <span className={`px-3 py-1 rounded-full text-sm\n              ${apt.status === 'cancelled' \n                ? 'bg-red-100 text-red-800' \n                : 'bg-green-100 text-green-800'}`}\n            >\n              {apt.status === 'cancelled' ? 'Annulé' : 'Effectué'}\n            </span>\n          </div>\n        </div>\n      ))}\n\n      {/* Afficher le bouton \"Voir plus\" uniquement s'il y a plus de 2 rendez-vous */}\n      {pastAppointments.length > 2 && (\n        <button\n        onClick={() => setShowAllAppointments(!showAllAppointments)}\n        className=\"w-full mt-4 flex items-center justify-center gap-2 text-gray-500 hover:text-gray-700 text-sm py-2\"\n      >\n        <span>{showAllAppointments ? 'Voir moins' : 'Voir plus'}</span>\n        {showAllAppointments ? (\n          <ChevronUp className=\"w-4 h-4\" />\n        ) : (\n          <ChevronDown className=\"w-4 h-4\" />\n        )}\n      </button>\n      \n      )}\n    </div>\n  </div>\n)}\n      \n            {appointment.status === 'confirmed' && (\n              <div className=\"text-center text-sm text-gray-500\">\n                <p>Un email de confirmation a été envoyé à {appointment.clientEmail}</p>\n              </div>\n            )}\n      \n            {/* Boutons du bas uniquement pour les rendez-vous confirmés */}\n            {appointment.status === 'confirmed' && (\n              <div className=\"flex justify-center gap-4\">\n                <Link href=\"/\">\n                  <Button variant=\"outline\">\n                    Réserver un autre rendez-vous\n                  </Button>\n                </Link>\n                <Button\n                  onClick={() => window.print()}\n                  variant=\"outline\"\n                >\n                  Imprimer\n                </Button>\n              </div>\n            )}\n      \n            {/* Bouton d'impression seul pour les rendez-vous annulés */}\n            {appointment.status === 'cancelled' && (\n              <div className=\"flex justify-center\">\n                <Button\n                  onClick={() => window.print()}\n                  variant=\"outline\"\n                >\n                  Imprimer\n                </Button>\n              </div>\n            )}\n          </Card>\n        </div>\n      );\n}"]}